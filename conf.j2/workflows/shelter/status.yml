resources:
  jobs:
    shelter_report:
      name: Shelter Status Layer Ingestion
      email_notifications:
        on_failure:
          - ${var.notification_email}

      schedule:
        quartz_cron_expression: "20 * * * * ?"
        timezone_id: "America/Los_Angeles"
      
      tasks:
        - task_key: "bronze_shelter_status_layer"
          existing_cluster_id: ${var.ahd_cluster_id}
          python_wheel_task:
            package_name: ${bundle.name}
            entry_point: medallion_task
            parameters: [ "--conf-file", "${var.param_files_dir}/shelter/status/bronze_shelter_status_layer.yml", "--stage", "${bundle.target}"]
          libraries:
            - whl: ../../../dist/*.whl

        - task_key: "silver_shelter_status_layer"
          existing_cluster_id: ${var.ahd_cluster_id}
          depends_on: 
            - task_key:  bronze_shelter_status_layer
          python_wheel_task:
            package_name: ${bundle.name}
            entry_point: medallion_task
            parameters: [ "--conf-file", "${var.param_files_dir}/shelter/status/silver_shelter_status_layer.yml", "--stage", "${bundle.target}"]
          libraries:
            - whl: ../../../dist/*.whl

